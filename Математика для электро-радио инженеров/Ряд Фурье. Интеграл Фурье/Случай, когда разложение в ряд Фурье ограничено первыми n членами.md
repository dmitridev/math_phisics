# Случай, когда разложение в ряд Фурье ограничено первыми n членами

Дана функция $f(x)$, определенная в интервале $(\theta,\theta + 2\pi)$ и тригонометрический ряд, который оборван на первых n членах. Коэффициенты ряда произвольны. Мы можем спросить себя, какими должны быть эти коэффициенты, чтобы сумма первых n членов тригонометрического ряда представляла наилучним образом функцию f(x) в рассмотренном интервале.

Пусть сумма первых n членов тригонометрического ряда равна

$$
    S_n(x) = b_0 + \sum^{n}_{k=1} a_k sin kx + \sum_{k=1}^{n} b_k cos\ kx.
$$

Определим выражение для коэффициентов ряда $a_k, b_k$ так, чтобы величина

$$
    E = \frac{1}{2\pi} \int_\theta^{\theta + 2\pi} [f(x) - S_n(x)]^2 dx  -
$$

средняя квадратичная ошибка, которую мы делаем, заменяя $f(x)$ на $S_n(x)$ в интервале от $\theta$ до $\theta + 2\pi$ - была минимальной.
Для этого нужно коэффициенты $a_k$ и $b_k$ выбрать так, чтобы

$$
 \frac{\partial E}{\partial a_1} = \frac{\partial E}{\partial a_2} = ... = \frac{\partial E}{\partial a_n} = \frac{\partial E}{\partial b_0} = \frac{\partial E}{\partial b_1} = ... = \frac{\partial E}{\partial b_n} = 0
$$

Обратимся к коэффициенту $a_m$. Он определяется из уравнения $\frac{\partial E}{\partial a_m} = 0:

$$
    \frac{\partial E}{\partial a_m} = -\frac1\pi \int_\theta^{\theta + 2\pi} [f(x) - S_n(x)] \frac{\partial S_n}{\partial a_m} dx = 0,
$$

$$
    \frac{\partial E}{\partial a_m} = -\frac1\pi \int_\theta^{\theta + 2\pi} \Big [  f(x) - b_0 - \sum_{k=1}^n a_k\ sin kx - \sum_{k=1}^{n} b_k cos kx \Big ] sin\ mx\ dx = 0.
$$

Это даёт нам

$$
    \frac{1}{\pi} \int_\theta^{\theta+2\pi} [f(x) - a_m sin\ mx] sinmxdx = 0.
$$

Отсюда получаем 
$$
    a_m = \frac{1}{\pi} \int_{\theta}^{\theta + 2\pi} f(x) sin\ mx\ dx.
$$

Следовательно, разложение в ряд Фурье не только точно представляет функцию f(x) при неограниченном числе членов, но и обеспечивает наименьшую среднюю квадратическую ошибку по сравнению с любым тригонометрическим рядом по $sin\ kx$ и $cos\ kx$, если эти ряды обрывать на произвольном конечном числе слагаемых. Замечательно что, при увеличении числа членом в конечной тригонометрической сумме $S_n(x)$ все прежние коэффициенты сохраняют свой вид.

Замечание. Рассуждения остуются точно такими же, если речь идёт о разложении в ряд по произвольной системе ортогональных функций $u(z)$. Это означает, что мы получим наилучшее представление функции f(x) в виде ограниченного ряда по ортогональным функциям, если коэффициенты разложения определяем по формуле (8). И здесь при увеличении числа членов в конечной сумме прежние коэффициенты сохраняют свой вид.