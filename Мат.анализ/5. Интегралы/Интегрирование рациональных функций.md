# Интегрирование рациональных функций

Рациональная функция (или рациональная дробь) $P_n(x)/Q_m(x)$ называется _правильной_, если $n<m$ (здесь m и n - степени многочленов $P_n(x) и Q_m(x)$). Правильную рациональную дробь можно разложить на сумму так называемых _простейших дробей_. Рассмотрим пример:

$$
    \frac{x}{x^4-1} = \frac{x}{(x-1)(x+1)(x^2+1)} = \frac{A}{x-1} + \frac{B}{x+1} + \frac{Cx+D}{x^2+1}=
$$

$$
    = \frac{x^3(A+B+C) + x^2(A-B+D) + x(A+B-C) + (A-B-D)}{(x-1)(x+1)(x^2+1)}.
$$

Отсюда, приравнивая коэффициенты при одинаковых степенях и числителях левой и правой дробей, получаем систему уравнений относительно A,B,C,D:
$$
    \begin{equation} 
        \begin{cases} 
            A+B+C = 0, \\ 
            A-B+D = 0, \\ 
            A+B-C = 1, \\ 
            A-B-D = 0,
        \end{cases}

    \end{equation}
$$

которая имеет единственное решение $A=B=1/4$, $C = -1/2$, В = 0.
Таким образом, искомое разложение имеет вид:
$$
    \frac{x}{x^4 - 1} = \frac1{4(x-1)} + \frac1{4(x+1)} - \frac{x}{2(x^2+1)}.
$$

Обратимся теперь к общему случаю произвольной правильной рациональной дроби $P_n(x)/Q_m(x)$. Пусть знаменатель $Q_m(x)$ имеет следующее разложение на множители:
$$
    Q_m(x) = (x-a)^\alpha ... (x-b)^\beta (x^2 + px + q)^\gamma ... (x^2 + rx + s)^\delta,
$$

где числа a...b - различные вещественные корни этого многочлена; $x^2 + px + q,...x^2 + rx + S$ - квадратные трехчлены с вещественными коэффициентами, имеющие комплексные (различные) корни; $\alpha,...,\delta$ - натуральные числа - кратности соответствующих корней, причем, как нетрудно видеть ($\alpha + .... + \beta$) + 2 ($\gamma + ... + \delta$) = $m$. Можно доказать, что всякий многочлен с вещественными коэффициентами имеет единственное разложение указанного вида; оно называется _разложением многочлена с вещественными коэффициентами на произведение неприводимых вещественных множителей_.

Правильную рациональную дробь $P_n(x)/Q_m(x)$, у которой знаменатель имеет приведенное выше представление, монжно разложить, и притом единственным образом, на сумму простейших дробей следующего вида:
$$
    \frac{P_n(x)}{Q_m(x)} = \frac{A_\alpha}{(x-a)^\alpha} + \frac{A_{\alpha - 1}}{(x-a)^{\alpha-1}} + ... + \frac{A_1}{(x-a)} + ... + \frac{B_\beta}{(x-b)^\beta} + ... + 
    \frac{L_{\delta x} + K_\delta}{(x^2 + rx + s)^\delta} + ... + \frac{L_1x + L_1}{x^2 + rx +s}.
$$

Коэффициенты $A_\alpha ,...,K_1$, можно определить  таким же способом, как в рассмотренном примере. Этот способ нахождение коэффициентов называется _методом неопределённых коэффициентов_.

Таким образом, интегрирование правильной рациональной дроби сводится к интегрированию простейших дробей четырёх типов. Рассмотрим интегралы от этих простейших дробей.
1) $ \int \frac{A}{x-a}dx = A \int \frac{d(x-a)}{x-a} = A \ln{|x-a|} + C$.
2) $ \int \frac{A}{(x-a)^\alpha} dx = A \int \frac{d(x-a)}{(x-a)^\alpha} = A(x-a)^{-\alpha+1} \frac1{-\alpha + 1} + C = \frac{A}{(1-\alpha)(x-a)^{\alpha -1}} + C $ ($\alpha \in \N, \alpha > 1$).
   
3) $ \int \frac{Mx + N}{x^2 + px + q} dx$,
причем $p^2 - 4q < 0$, и следовательно, квадратный трёхчлен $x^2 + px + q$ имеем комплексные корни.

Введем обозначение $a^2 = q - \frac{p^2}4$ и сделаем замену переменной $t = x + p/2$. Тогда $x^2 + px + q = (x+p/2)^2 + (q-p^2/4) = t^2 + a^2$, $x = t - p/2$, $dx = dt$. Следовательно,
$$
    \int \frac{Mx + N}{x^2 + px + q}dx = \int \frac{M(t-p/2) + N}{t^2 + a^2} dt = M \int \frac{tdt}{t^2 + a^2} + (N - \frac{Mp}2) \int \frac{dt}{t^2 + a^2} = \frac{M}2 \int \frac{d(t^2 + a^2 )}{t^2 + a^2} + (N - \frac{Mp}2) \frac1a \int \frac{d(t/a)}{1 + (t/a)^2} = \frac{M}{2} \ln{(x^2 + px + q)} + \frac{2N - Mp}{2 \sqrt{q - p^2/4}} \arctg{\frac{x + p/2}{\sqrt{q - p^2/4}}} + C.
 $$

 4) $$\int \frac{Mx + N}{(x^2+px+q)^\alpha}dx$$

причём $\alpha \in \N ,\ \alpha > 1$, а квадратный трёхчлен x^2 + px + q имеет комплексные корни.

Снова введем обозначение $a^2 = q - \frac{p^2}4$ и сделаем замену переменной $t = x + p/2$.

Тогда
$$
    \int {Mx + N}{(x^2 + px + q)^\alpha} dx = \int \frac{Mt + (N-mp/2)}{(t^2 + a^2)^\alpha}dx = 
$$

$$
     = \frac{M}2 \int \frac{d(t^2 + a^2)}{(t^2 + a^2)^\alpha} + (N - Mp/2) \int \frac{dt}{(t^2 + a^2)^\alpha} =
$$
$$
     = \frac{M}{2(1 - \alpha)(t^2 + a^2)^{\alpha - 1}} + (N - Mp/2) J_\alpha,
$$

где $J_a = \int \frac{dt}{(t^2 + a^2)^\alpha} \ (\alpha > 1)$. Для вычисления интеграла $J_\alpha$ воспользуемся методом интегрирования по частям, считая $\alpha \geq 1:$
$$
    J_\alpha = \int \frac{dt}{(t^2 + a^2)^\alpha} = \frac{t}{(t^2 + a^2)^\alpha} - \int td (\frac1{(t^2 + a^2)^\alpha}) = \frac{t}{(t^2 + a^2)^\alpha}
$$

$$
    - \int t(-\alpha)(t^2 + a^2)^{-\alpha - 1} \cdot 2tdt = \frac{t}{(t^2+a^2)^\alpha} + 2a \int \frac{t^2 + a^2 - a^2}{((t^2 + a^2)^{\alpha + 1})}dt = 
$$

$$
    = \frac{t}{(t^2 + a^2)^\alpha} + 2\alpha \Bigg [ \int \frac{dt}{(t^2 + a^2)} - a^2 \int \frac{dt}{(t^2 + a^2)^{\alpha + 1}} \Bigg ]
$$

$$
    = \frac{t}{(t^2 + a^2)}^\alpha + 2 \alpha J_a - 2\alpha a^2 J_{\alpha + 1}.
$$

Отсюда получаем рекуррентную формулу для вычисления $J_a$:
$$
    J_{\alpha + 1} = \frac1{2\alpha a^2} \Bigg [ \frac{t}{(t^2 + a^2)} + \frac1a \arctg{\frac{t}{a}} \Bigg ] + C;
$$
полагая в реккурентной формуле $\alpha = 2$ и зная $J_2$, найдем $J_3$, и т.д.

Таким образом, каждая из простейших дробей интересуется в элементарных функциях.
Если рациональная дробь $P_n(x) / Q_m(x)$ неправильная, т.е. $n \geq m$, то разделив $P_n(x) на Q_m(x)$, получим 
$$
    P_n(x) = Q_m(x) \cdot T_{n-m} (x) + R_k(x),
$$

где $T_{n-m}(x)$ и $R_k(x)$ - многочлены степени n-m и k, причём k < m. Отсюда
$$
    \frac{P_n(x)}{Q_m(x)} = T_{n-m}(x) + \frac{R_k(x)}{Q_m(x)},
$$

где второе слагаемое в правой части равенства представляет собой правильную рациональную дробь. Тем самым, интегрирование неправильной рациональной дроби сводится к интегрированию многочлена и правильной рациональной дроби.
_Общий вывод_: любая рациональная функция интегрируется в _элементарных функциях_.

_Замечание_ . Пусть $Q_m(x) = (x-a)^\alpha \phi(x)$, где $\phi(a) \neq 0$, т.е. x = a - вещественный корень кратности $\alpha$. Тогда
$$
    \frac{P_n(x)}{Q_m(x)} = \frac{P_n(x)}{(x-a)^\alpha \phi(x)} = \frac{A_\alpha}{(x-a)^\alpha} + \frac{A_{\alpha-1}}{(x-a)^{\alpha - 1}} + ...
$$
Умножив последнее равенство на $(x-a)^\alpha$ и положив затем x = a, получим:
$$
    A_\alpha = \frac{P_n(a)}{\phi(a)} = \frac{P_n(x)}{\phi(x)} \Bigg |_{x=a}
$$

Таким образом, чтобы найти коэффициент $A_\alpha$, нужно в дроби $ \frac{P_n(x)}{(x-a)^\alpha \phi (x)}$ вычеркнуть в знаменателе множитель $(x-a)^\alpha$, а затем в оставшемся выражении положить x = a. Такой способ нахождения коэффициента $A_\alpha$ называется _методом вычёркивания_.