# Необходимое и достаточное условие интегрируемости функции

_Теорема_. Для того чтобы ограниченная на сегменте функция была интегрируемой на этом сегменте, необходимо и достаточно, чтобы $\underline{I} = \overline{I}$.

_Доказательство_. 
а) Необходимость. Пусть функция $f(x)$ интегрируема на сегменте [a,b], то есть существует $\lim_{\Delta \to 0} I(x_i,\xi_i) = I$.

Тогда, согласно определению предела интегральных сумм, $\forall \epsilon > 0$ $\exist \delta > 0$, такое, что для любого разбиения сегмента [a,b], у которого $\Delta < \delta$, и для любого выбора разбиения сегмента [a,b], у которого $\Delta < \delta$, и для любого выбора промежуточных точек $\xi_i$ выполняется неравенство $|I(x_i,\xi_i) - I| < \epsilon/4$. Зафиксируем какое-нибудь одно из таких разбиений. Пусть его суммы Дарбу равны s и S.
В силу свойства I (см. равенства (5.7)) можно так выбрать точки $\xi_i$ (обозначим их $\xi_i'$), что будет выполнено неравенство $I(x_i,\xi_i') - s < \epsilon/4$, и можно выбрать их так, что (обозначим выбор через $\xi_i"$), что $S - I(x_i,\xi_i") < \epsilon/4$.
Используя эти неравенства, получаем, что для зафиксированного нами разбиения справедливы соотношения
$$
    S - s = [S - I(x_i,\xi_i")] + [I(x_i,\xi_i") - I] + [I - I(x_i,\xi_i')] + [I(x_i,\xi_i') - s] < \epsilon,
$$

поскольку каждое из выражений в квадратных скобках меньше $\epsilon/4$.

Воспользуемся теперь неравенствами (5.10):
$$
    s \leq \underline{I} \leq \overline{I} \leq S.
$$

Из этих неравенство и неравенства $S-s < \epsilon$ следует, что 
$$
    0 \leq \overline{I} - \underline{I} < \epsilon.
$$
Так как $\epsilon$ - произвольное положительное число, то $\underline{I} -  \overline{I} = 0$, то есть $\underline{I} = \overline{I}$.

Необходимость условия $\underline{I} = \overline{I}$ для интегрируемости $f(x)$ на сегменте [a,b] доказана.
_Замечание_. Попутно мы установили, что если f(x) интегрируема на сегменте [a,b], то $\forall \epsilon > 0$ существует такое разбиение сегменте [a,b], для которого S - s < \epsilon.
б) _Достаточность_. Пусть $\underline{I} = \overline{I} = I$. По лемме Дарбу $\lim_{\Delta \to 0} s = I$ и $\lim_{\Delta \to 0} S = I$, а так как для любого разбиения $s \leq I (x_i,\xi_i) \leq S$ (неравенства (5.6)), то $\lim_{\Delta \to 0} I(x_i,\xi_i) = I$. Это и означает, что f(x) интегрируема на сегменте [a,b]. Теорема 4 доказана.

_Пример_. Снова рассмотрим функцию Дирихле:
$$
    \begin{equation} 
        f(x) = \begin{cases} 
            1, \text{если x - рациональное число,} \\ 
            0, \text{если x - иррациональное число}
        \end{cases}
        x \in [a,b]
    \end{equation}
$$

Для любого разбиения сегмента [a,b] имеем: s = 0, S=b-a. Поэтому 
$$
    I = sup{s} = 0, \ \overline{I} = inf{S} = b-a.
$$
Таким образом, $\underline{I} \neq \overline{I}$, поэтому, согласно теореме 4, функция Дирихле не интегрируема ни на одном сегменте.

_Теорема 5_. Для того, чтобы ограниченная на сегменте [a,b] функция была интегрируемой на этом сегменте, необходимо и достаточно, чтобы $\forall \epsilon > 0$ существовало такое разбиение сегмента [a,b] (хотя бы одно), для которого S - s < \epsilon.

_Доказательство_
а) _Необходимость_ См. Замечание после доказательства необходимости в теореме 4.
б) _Достаточность_ Пусть $\forall \epsilon > 0$ существует разбиение сегмента [a,b], для которого $S - s  < \epsilon$. Снова воспользуемся неравенствами (5.10):
$$
    s \leq \underline{I} \leq \overline{I} \leq S.
$$
из которых следует, что $0 \leq \underline{I} - \overline{I} < \epsilon$, откуда в силу произвольности $\epsilon$ получаем $\underline{I} = \overline{I}$. По теореме 4 функция интегрируема на сегменте [a,b], что и требовалось доказать. Теорема 5 доказана.

_Замечание_. Используем обозначения 
$$
    M_i = \sup_{[x_{i-1},x_i]} f(x), \ m_i = \inf_{[x_{i-1},x_i]} f(x)
$$

введем величину $\omega_i = M_i - m_i$ и назовем её колебанием функции f(x) на частичном сегменте $[x_{i-1},x_i]$. Тогда разность $S - s$ можно записать в виде
$$
    S-s = \sum_{i=1}^n M_i \Delta x_i - \sum_{i=1}^n m_i \Delta x_i = \sum_{i=1}^n \omega_i \Delta x_i.
$$